# AIçµ±åˆã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€OpenAI GPT-4oã¾ãŸã¯Anthropic Claude 3.5 Sonnetã‚’ä½¿ç”¨ã—ã¦Neuro mateã®AIæ©Ÿèƒ½ã‚’æœ‰åŠ¹ã«ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ“‹ ç›®æ¬¡

1. [APIã‚­ãƒ¼ã®å–å¾—](#1-apiã‚­ãƒ¼ã®å–å¾—)
2. [ç’°å¢ƒå¤‰æ•°ã®è¨­å®š](#2-ç’°å¢ƒå¤‰æ•°ã®è¨­å®š)
3. [å‹•ä½œç¢ºèª](#3-å‹•ä½œç¢ºèª)
4. [æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤](#4-æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤)

## 1. APIã‚­ãƒ¼ã®å–å¾—

### Option A: OpenAI GPT-4oï¼ˆæ¨å¥¨ï¼‰

**ç‰¹å¾´:**
- âœ… é«˜é€Ÿï¼ˆå¿œç­”æ™‚é–“: 1-3ç§’ï¼‰
- âœ… ã‚³ã‚¹ãƒˆåŠ¹ç‡è‰¯å¥½ï¼ˆ$0.01-0.05/ç›¸è«‡ï¼‰
- âœ… JSONå‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«å¯¾å¿œ
- âœ… æ—¥æœ¬èªã®ç†è§£ã¨ç”Ÿæˆã«å„ªã‚Œã¦ã„ã‚‹

**å–å¾—æ‰‹é †:**
1. https://platform.openai.com/ ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆã¾ãŸã¯ãƒ­ã‚°ã‚¤ãƒ³
3. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€ŒAPI keysã€ã‚’ã‚¯ãƒªãƒƒã‚¯
4. ã€ŒCreate new secret keyã€ã‚’ã‚¯ãƒªãƒƒã‚¯
5. ã‚­ãƒ¼ã«åå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ï¼ˆä¾‹: "neuro-mate-production"ï¼‰
6. ç”Ÿæˆã•ã‚ŒãŸAPIã‚­ãƒ¼ã‚’ã‚³ãƒ”ãƒ¼ï¼ˆ`sk-proj-...`ã§å§‹ã¾ã‚‹æ–‡å­—åˆ—ï¼‰
7. **é‡è¦:** ã“ã®APIã‚­ãƒ¼ã¯å†è¡¨ç¤ºã•ã‚Œãªã„ãŸã‚ã€å®‰å…¨ã«ä¿ç®¡ã—ã¦ãã ã•ã„

**åˆæœŸã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ:**
- æ–°è¦ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ã¯é€šå¸¸$5ã®ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆãŒä»˜ä¸ã•ã‚Œã¾ã™
- è¿½åŠ ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã¯ https://platform.openai.com/account/billing ã§è³¼å…¥å¯èƒ½

### Option B: Anthropic Claude 3.5 Sonnet

**ç‰¹å¾´:**
- âœ… é•·æ–‡ç†è§£ã«å„ªã‚Œã¦ã„ã‚‹
- âœ… è«–ç†çš„æ€è€ƒã¨åˆ†æã«å¼·ã„
- âœ… è¤‡é›‘ãªæŒ‡ç¤ºã«å¯¾å¿œå¯èƒ½
- âš ï¸ OpenAIã‚ˆã‚Šè‹¥å¹²é«˜ä¾¡ï¼ˆ$0.015-0.06/ç›¸è«‡ï¼‰

**å–å¾—æ‰‹é †:**
1. https://console.anthropic.com/ ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆã¾ãŸã¯ãƒ­ã‚°ã‚¤ãƒ³
3. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€ŒAPI Keysã€ã‚’ã‚¯ãƒªãƒƒã‚¯
4. ã€ŒCreate Keyã€ã‚’ã‚¯ãƒªãƒƒã‚¯
5. ã‚­ãƒ¼ã«åå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ï¼ˆä¾‹: "neuro-mate-production"ï¼‰
6. ç”Ÿæˆã•ã‚ŒãŸAPIã‚­ãƒ¼ã‚’ã‚³ãƒ”ãƒ¼ï¼ˆ`sk-ant-...`ã§å§‹ã¾ã‚‹æ–‡å­—åˆ—ï¼‰

**ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆè³¼å…¥:**
- https://console.anthropic.com/settings/billing ã§ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚’è³¼å…¥

## 2. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«`.dev.vars`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼š

```bash
# .dev.vars ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ
cat > .dev.vars << 'EOF'
# JWT Secretï¼ˆãƒ©ãƒ³ãƒ€ãƒ ãªæ–‡å­—åˆ—ã‚’è¨­å®šï¼‰
JWT_SECRET=your-random-secret-key-here-change-this

# AI Providerï¼ˆopenai, anthropic, ã¾ãŸã¯ mockï¼‰
AI_PROVIDER=openai

# OpenAIè¨­å®šï¼ˆOpenAIã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼‰
OPENAI_API_KEY=sk-proj-your-openai-api-key-here
OPENAI_MODEL=gpt-4o

# Anthropicè¨­å®šï¼ˆAnthropicã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼‰
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022
EOF
```

**å®Ÿéš›ã®å€¤ã«ç½®ãæ›ãˆã¦ãã ã•ã„:**

```bash
# OpenAIã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ
AI_PROVIDER=openai
OPENAI_API_KEY=sk-proj-ABC123...ï¼ˆå®Ÿéš›ã®APIã‚­ãƒ¼ï¼‰
OPENAI_MODEL=gpt-4o

# Anthropicã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ
AI_PROVIDER=anthropic
ANTHROPIC_API_KEY=sk-ant-XYZ789...ï¼ˆå®Ÿéš›ã®APIã‚­ãƒ¼ï¼‰
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022
```

### ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ï¼ˆé–‹ç™ºç”¨ï¼‰

APIã‚³ã‚¹ãƒˆã‚’ã‹ã‘ãšã«ãƒ†ã‚¹ãƒˆã—ãŸã„å ´åˆ:

```bash
AI_PROVIDER=mock
```

ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ã§ã¯ã€å®Ÿéš›ã®AI APIã‚’å‘¼ã³å‡ºã•ãšã€å›ºå®šã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã—ã¾ã™ã€‚

## 3. å‹•ä½œç¢ºèª

### ã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

```bash
# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆåˆå›ã®ã¿ï¼‰
npm install

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆåˆå›ã®ã¿ï¼‰
npm run db:migrate:local

# ãƒ“ãƒ«ãƒ‰
npm run build

# ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
pm2 start ecosystem.config.cjs

# ãƒ­ã‚°ç¢ºèª
pm2 logs neuro-mate --nostream
```

### AIæ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ

è©³ç´°ãªãƒ†ã‚¹ãƒˆæ‰‹é †ã¯ `test-ai-integration.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

**ç°¡å˜ãªãƒ†ã‚¹ãƒˆ:**

```bash
# 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²
curl -X POST http://localhost:3000/api/auth/signup \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"test123"}'

# ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã—ã¦ãã ã•ã„

# 2. AIç›¸è«‡ãƒ†ã‚¹ãƒˆï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç½®ãæ›ãˆã¦ãã ã•ã„ï¼‰
curl -X POST http://localhost:3000/api/ai/consult \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN_HERE" \
  -d '{
    "currentConcerns": "é¦–è‚©ã®ã‚³ãƒªã¨ç¡çœ ä¸è¶³ãŒæ°—ã«ãªã‚Šã¾ã™",
    "lifestyleRhythm": "ãƒ‡ã‚¹ã‚¯ãƒ¯ãƒ¼ã‚¯ä¸­å¿ƒã§é‹å‹•ä¸è¶³ã§ã™",
    "additionalNotes": "ã‚µãƒ—ãƒªãƒ¡ãƒ³ãƒˆã‚’è©¦ã—ã¦ã¿ãŸã„ã§ã™"
  }'
```

**æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ:**
- âœ… AIãŒç›¸è«‡å†…å®¹ã‚’åˆ†æã—ã¦ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ
- âœ… ã‚µãƒ—ãƒªãƒ¡ãƒ³ãƒˆã®ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã¨æ¨å¥¨ç†ç”±
- âœ… ã‚»ãƒ«ãƒ•ã‚±ã‚¢ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ææ¡ˆ
- âœ… ç”Ÿæ´»ç¿’æ…£æ”¹å–„ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹

**ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°:**
- âŒ APIã‚­ãƒ¼ã‚¨ãƒ©ãƒ¼: `.dev.vars`ã®APIã‚­ãƒ¼ã‚’ç¢ºèª
- âŒ ãƒ—ãƒ©ãƒ³åˆ¶é™ã‚¨ãƒ©ãƒ¼: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ—ãƒ©ãƒ³ã‚’ç¢ºèª
- âŒ ãƒ¢ãƒƒã‚¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹: APIã‚¨ãƒ©ãƒ¼æ™‚ã¯è‡ªå‹•çš„ã«ãƒ¢ãƒƒã‚¯ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯

## 4. æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤

### Cloudflare Pagesã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤

**å‰ææ¡ä»¶:**
- Cloudflareã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
- Wrangler CLIãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ï¼ˆ`npm install -g wrangler`ï¼‰

**æ‰‹é †:**

1. **Cloudflare D1ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä½œæˆ**

```bash
# æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ
wrangler d1 create webapp-production

# å‡ºåŠ›ã•ã‚ŒãŸdatabase_idã‚’wrangler.tomlã«è¨­å®š
# database_id = "your-database-id-here"
```

2. **ç’°å¢ƒå¤‰æ•°ï¼ˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆï¼‰ã®è¨­å®š**

```bash
# å¿…é ˆ: JWT Secret
wrangler pages secret put JWT_SECRET --project-name webapp
# å…¥åŠ›: ãƒ©ãƒ³ãƒ€ãƒ ãªé•·ã„æ–‡å­—åˆ—

# å¿…é ˆ: AI Provider
wrangler pages secret put AI_PROVIDER --project-name webapp
# å…¥åŠ›: openai ã¾ãŸã¯ anthropic

# OpenAIä½¿ç”¨æ™‚
wrangler pages secret put OPENAI_API_KEY --project-name webapp
# å…¥åŠ›: sk-proj-...

wrangler pages secret put OPENAI_MODEL --project-name webapp
# å…¥åŠ›: gpt-4o

# Anthropicä½¿ç”¨æ™‚ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
wrangler pages secret put ANTHROPIC_API_KEY --project-name webapp
# å…¥åŠ›: sk-ant-...

wrangler pages secret put ANTHROPIC_MODEL --project-name webapp
# å…¥åŠ›: claude-3-5-sonnet-20241022
```

3. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**

```bash
# æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¹ã‚­ãƒ¼ãƒã‚’é©ç”¨
wrangler d1 migrations apply webapp-production
```

4. **ãƒ‡ãƒ—ãƒ­ã‚¤**

```bash
# ãƒ“ãƒ«ãƒ‰ã¨ãƒ‡ãƒ—ãƒ­ã‚¤
npm run deploy
```

5. **ç¢ºèª**

ãƒ‡ãƒ—ãƒ­ã‚¤ãŒæˆåŠŸã™ã‚‹ã¨ã€Cloudflare Pagesã®URLãŒè¡¨ç¤ºã•ã‚Œã¾ã™:
- æœ¬ç•ªURL: `https://webapp.pages.dev`
- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼URL: `https://BRANCH.webapp.pages.dev`

## ğŸ’° ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Š

### OpenAI GPT-4o
- **å…¥åŠ›:** $2.50 / 1M ãƒˆãƒ¼ã‚¯ãƒ³
- **å‡ºåŠ›:** $10.00 / 1M ãƒˆãƒ¼ã‚¯ãƒ³
- **1å›ã®ç›¸è«‡:** ç´„ $0.01 - $0.05
- **æœˆé–“1000ç›¸è«‡:** ç´„ $10 - $50

### Anthropic Claude 3.5 Sonnet
- **å…¥åŠ›:** $3.00 / 1M ãƒˆãƒ¼ã‚¯ãƒ³
- **å‡ºåŠ›:** $15.00 / 1M ãƒˆãƒ¼ã‚¯ãƒ³
- **1å›ã®ç›¸è«‡:** ç´„ $0.015 - $0.06
- **æœˆé–“1000ç›¸è«‡:** ç´„ $15 - $60

### ã‚³ã‚¹ãƒˆæœ€é©åŒ–ã®ãƒ’ãƒ³ãƒˆ
1. **é–‹ç™ºä¸­ã¯ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰**ã‚’ä½¿ç”¨
2. **ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ**ã§ãƒ†ã‚¹ãƒˆã—ã¦ã‹ã‚‰æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤
3. **ã‚¨ãƒ©ãƒ¼å‡¦ç†**ã‚’é©åˆ‡ã«å®Ÿè£…ã—ã¦APIå‘¼ã³å‡ºã—å¤±æ•—ã‚’é˜²ã
4. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥**ã‚’æ´»ç”¨ã—ã¦åŒã˜ç›¸è«‡ã®å†è¨ˆç®—ã‚’é¿ã‘ã‚‹
5. **ãƒ­ã‚°ç›£è¦–**ã§APIä½¿ç”¨é‡ã‚’è¿½è·¡

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

1. **APIã‚­ãƒ¼ã®ä¿è­·:**
   - âŒ Gitã«APIã‚­ãƒ¼ã‚’ã‚³ãƒŸãƒƒãƒˆã—ãªã„
   - âœ… `.gitignore`ã«`.dev.vars`ã‚’è¿½åŠ 
   - âœ… ç’°å¢ƒå¤‰æ•°ã¾ãŸã¯ç§˜å¯†ç®¡ç†ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨

2. **ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡:**
   - âœ… JWTèªè¨¼ã§APIä¿è­·
   - âœ… ãƒ—ãƒ©ãƒ³åˆ¥ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’å®Ÿè£…
   - âœ… ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’è¨­å®š

3. **ç›£è¦–:**
   - âœ… APIä½¿ç”¨é‡ã‚’å®šæœŸçš„ã«ãƒã‚§ãƒƒã‚¯
   - âœ… ç•°å¸¸ãªä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚¢ãƒ©ãƒ¼ãƒˆ
   - âœ… ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ç›£è¦–

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

- [OpenAI Platform Documentation](https://platform.openai.com/docs)
- [Anthropic Claude Documentation](https://docs.anthropic.com/)
- [Cloudflare Workers Documentation](https://developers.cloudflare.com/workers/)
- [Hono Framework Documentation](https://hono.dev/)

## ğŸ†˜ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆ:
1. `test-ai-integration.md`ã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç¢ºèª
2. `pm2 logs neuro-mate`ã§ã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°ã‚’ç¢ºèª
3. APIãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ä½¿ç”¨é‡ã¨ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª

---

âœ¨ **AIçµ±åˆãŒå®Œäº†ã—ã¾ã—ãŸ!** ã‚ãªãŸã®Neuro mateã¯ã€ä¸–ç•Œæœ€å…ˆç«¯ã®AIã‚’æ´»ç”¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æœ€é«˜ã®ãƒ˜ãƒ«ã‚¹ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’æä¾›ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
